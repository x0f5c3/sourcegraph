import { selectorCompletion } from './selectFilter'
import { Literal, createLiteral } from './token'

expect.addSnapshotSerializer({
    serialize: (value: string[]): string => value.join(',\n'),
    test: () => true,
})

const create = (value: string): Literal => createLiteral(value, { start: 0, end: 0 })

describe('selectorCompletion', () => {
    test('suggest depth 0 completions', () => {
        expect(selectorCompletion(create('foo'))).toMatchInlineSnapshot(`
            repo,
            file,
            content,
            symbol,
            commit
        `)
    })

    test('suggest depth 1 symbol completions', () => {
        expect(selectorCompletion(create('symbol.f'))).toMatchInlineSnapshot(`
            symbol,
            symbol.Constructor,
            symbol.Exception,
            symbol.File,
            symbol.L1Header,
            symbol.L2Header,
            symbol.L3Header,
            symbol.L4Header,
            symbol.L5Header,
            symbol.L6Header,
            symbol.NAME,
            symbol.RecordField,
            symbol.accelerators,
            symbol.accessor,
            symbol.activeBindingFunc,
            symbol.alias,
            symbol.altstep,
            symbol.anchor,
            symbol.annotation,
            symbol.anon,
            symbol.anonMember,
            symbol.antfile,
            symbol.architecture,
            symbol.arg,
            symbol.array,
            symbol.article,
            symbol.artifactId,
            symbol.assembly,
            symbol.assert,
            symbol.attribute,
            symbol.augroup,
            symbol.autovar,
            symbol.benchmark,
            symbol.bibitem,
            symbol.bitmap,
            symbol.block,
            symbol.blockData,
            symbol.book,
            symbol.booklet,
            symbol.boolean,
            symbol.build,
            symbol.callback,
            symbol.category,
            symbol.ccflag,
            symbol.cell,
            symbol.chapter,
            symbol.checker,
            symbol.choice,
            symbol.chunklabel,
            symbol.citation,
            symbol.class,
            symbol.clocking,
            symbol.combo,
            symbol.command,
            symbol.common,
            symbol.component,
            symbol.cond,
            symbol.condition,
            symbol.conference,
            symbol.config,
            symbol.const,
            symbol.constant,
            symbol.constraint,
            symbol.constructor,
            symbol.context,
            symbol.counter,
            symbol.covergroup,
            symbol.cursor,
            symbol.custom,
            symbol.data,
            symbol.database,
            symbol.dataframe,
            symbol.def,
            symbol.define,
            symbol.definition,
            symbol.delegate,
            symbol.deletedFile,
            symbol.derivedMode,
            symbol.describe,
            symbol.dialog,
            symbol.directory,
            symbol.division,
            symbol.document,
            symbol.domain,
            symbol.edesc,
            symbol.element,
            symbol.entity,
            symbol.entry,
            symbol.entryspec,
            symbol.enum,
            symbol.enumConstant,
            symbol.enumerator,
            symbol.environment,
            symbol.error,
            symbol.event,
            symbol.exception,
            symbol.externvar,
            symbol.face,
            symbol.fd,
            symbol.feature,
            symbol.field,
            symbol.filename,
            symbol.font,
            symbol.footnote,
            symbol.formal,
            symbol.format,
            symbol.fragment,
            symbol.framesubtitle,
            symbol.frametitle,
            symbol.fun,
            symbol.func,
            symbol.function,
            symbol.functionVar,
            symbol.functor,
            symbol.gem,
            symbol.generator,
            symbol.generic,
            symbol.getter,
            symbol.global,
            symbol.globalVar,
            symbol.grammar,
            symbol.group,
            symbol.groupId,
            symbol.guard,
            symbol.handler,
            symbol.header,
            symbol.heading1,
            symbol.heading2,
            symbol.heading3,
            symbol.heredoc,
            symbol.hunk,
            symbol.icon,
            symbol.id,
            symbol.identifier,
            symbol.ifclass,
            symbol.implementation,
            symbol.import,
            symbol.inbook,
            symbol.incollection,
            symbol.index,
            symbol.infoitem,
            symbol.inline,
            symbol.inproceedings,
            symbol.inputSection,
            symbol.instance,
            symbol.integer,
            symbol.interface,
            symbol.iparam,
            symbol.it,
            symbol.kconfig,
            symbol.key,
            symbol.keyword,
            symbol.kind,
            symbol.l4subsection,
            symbol.l5subsection,
            symbol.label,
            symbol.langdef,
            symbol.langstr,
            symbol.library,
            symbol.list,
            symbol.literal,
            symbol.local,
            symbol.localVariable,
            symbol.localvar,
            symbol.loggerSection,
            symbol.ltlibrary,
            symbol.macro,
            symbol.macroParameter,
            symbol.macrofile,
            symbol.macroparam,
            symbol.mainMenu,
            symbol.makefile,
            symbol.man,
            symbol.manual,
            symbol.map,
            symbol.mastersthesis,
            symbol.matchedTemplate,
            symbol.member,
            symbol.menu,
            symbol.message,
            symbol.method,
            symbol.methodSpec,
            symbol.minorMode,
            symbol.misc,
            symbol.mixin,
            symbol.mlconn,
            symbol.mlprop,
            symbol.mltable,
            symbol.modifiedFile,
            symbol.modport,
            symbol.module,
            symbol.modulepar,
            symbol.multitask,
            symbol.mxtag,
            symbol.name,
            symbol.nameattr,
            symbol.namedPattern,
            symbol.namedTemplate,
            symbol.namelist,
            symbol.namespace,
            symbol.net,
            symbol.nettype,
            symbol.newFile,
            symbol.node,
            symbol.notation,
            symbol.nsprefix,
            symbol.null,
            symbol.number,
            symbol.object,
            symbol.oneof,
            symbol.oparam,
            symbol.operator,
            symbol.optenable,
            symbol.option,
            symbol.optwith,
            symbol.package,
            symbol.packageName,
            symbol.packspec,
            symbol.paragraph,
            symbol.param,
            symbol.parameter,
            symbol.parameterEntity,
            symbol.part,
            symbol.patch,
            symbol.path,
            symbol.pattern,
            symbol.phandler,
            symbol.phdthesis,
            symbol.pkg,
            symbol.placeholder,
            symbol.play,
            symbol.port,
            symbol.probe,
            symbol.procedure,
            symbol.proceedings,
            symbol.process,
            symbol.program,
            symbol.project,
            symbol.property,
            symbol.protected,
            symbol.protectspec,
            symbol.protocol,
            symbol.protodef,
            symbol.prototype,
            symbol.publication,
            symbol.qmp,
            symbol.qualname,
            symbol.receiver,
            symbol.record,
            symbol.regex,
            symbol.region,
            symbol.register,
            symbol.reopen,
            symbol.repoid,
            symbol.repositoryId,
            symbol.repr,
            symbol.resource,
            symbol.response,
            symbol.role,
            symbol.root,
            symbol.rpc,
            symbol.rule,
            symbol.run,
            symbol.schema,
            symbol.script,
            symbol.section,
            symbol.sectionGroup,
            symbol.selector,
            symbol.sequence,
            symbol.server,
            symbol.service,
            symbol.set,
            symbol.setter,
            symbol.signal,
            symbol.signature,
            symbol.singletonMethod,
            symbol.slot,
            symbol.source,
            symbol.sourcefile,
            symbol.step,
            symbol.string,
            symbol.struct,
            symbol.structure,
            symbol.stylesheet,
            symbol.subdir,
            symbol.submethod,
            symbol.submodule,
            symbol.subparagraph,
            symbol.subprogram,
            symbol.subprogspec,
            symbol.subroutine,
            symbol.subroutineDeclaration,
            symbol.subsection,
            symbol.subspec,
            symbol.subst,
            symbol.substdef,
            symbol.subsubsection,
            symbol.subtitle,
            symbol.subtype,
            symbol.symbol,
            symbol.synonym,
            symbol.table,
            symbol.tag,
            symbol.talias,
            symbol.target,
            symbol.task,
            symbol.taskspec,
            symbol.techreport,
            symbol.template,
            symbol.test,
            symbol.testcase,
            symbol.theme,
            symbol.theorem,
            symbol.thriftFile,
            symbol.throwsparam,
            symbol.timer,
            symbol.title,
            symbol.token,
            symbol.toplevelVariable,
            symbol.tparam,
            symbol.trait,
            symbol.trigger,
            symbol.type,
            symbol.typealias,
            symbol.typedef,
            symbol.typespec,
            symbol.union,
            symbol.unit,
            symbol.unknown,
            symbol.unpublished,
            symbol.username,
            symbol.using,
            symbol.val,
            symbol.value,
            symbol.var,
            symbol.varalias,
            symbol.variable,
            symbol.varspec,
            symbol.vector,
            symbol.version,
            symbol.view,
            symbol.virtual,
            symbol.vresource,
            symbol.wrapper,
            symbol.xinput,
            symbol.xtask,
        `)
    })

    test('suggest depth 2 commit.diff completions', () => {
        expect(selectorCompletion(create('commit.diff.'))).toMatchInlineSnapshot(`
            commit,
            commit.diff,
            commit.diff.added,
            commit.diff.removed
        `)
    })
})
